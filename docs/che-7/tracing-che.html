<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=",  ">
<title>Tracing Che | Eclipse Che Documentation</title>
<link rel="stylesheet" href="/che/docs/css/syntax.css">
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="/che/docs/css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="/che/docs/css/customstyles.css">
<link rel="stylesheet" href="/che/docs/css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="/che/docs/css/theme-che.css">


    <link rel="stylesheet" href="/che/docs/css/coderay.css" media="screen" type="text/css">
    <link rel="stylesheet" href="/che/docs/css/asciidoc.css" type="text/css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js" crossorigin="anonymous"></script>
<script src="/che/docs/js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js" crossorigin="anonymous"></script>
<script src="/che/docs/js/toc.js"></script>
<script src="/che/docs/js/customscripts.js"></script>

<link rel="shortcut icon" href="/che/docs/images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="che" href="/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Eclipse Che Documentation</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://medium.com/eclipse-che-blog/" target="_blank">Blog</a></li>
                
                
                
                <li><a href="https://github.com/eclipse/che" target="_blank">Source Code</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Che Version<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="/che/docs/che-6/index.html">Che 6</a></li>
                        
                        
                        
                        <li><a href="/che/docs/che-7/index.html">Che 7 Beta</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Get Support<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/eclipse/che/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3Akind%2Fbug" target="_blank">Known Bugs</a></li>
                        
                        
                        
                        <li><a href="https://github.com/eclipse/che/issues/new" target="_blank">File an Issue</a></li>
                        
                        
                        
                        <li><a href="https://stackoverflow.com/questions/tagged/eclipse-che" target="_blank">Che on StackOverflow</a></li>
                        
                        
                    </ul>
                </li>
                
                
                <!-- 
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:?subject= feedback&body=I have some feedback about the Tracing Che page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>
 -->
		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="/che/docs/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: "/che/docs/search.json",
                                searchResultTemplate: '<li><a href="{url}" title="Tracing Che">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a href="#">Overview</a>
      <ul>
          
          
          
          <li><a href="introduction-to-eclipse-che.html">Introduction to Che</a></li>
          
          
          
          
          
          
          <li><a href="che-quick-starts.html">Che quick-starts</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">End-user Guide</a>
      <ul>
          
          
          
          <li><a href="using-developer-environments-workspaces.html">Using developer environments - workspaces</a></li>
          
          
          
          
          
          
          <li><a href="extending-che.html">Extending Che</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Administration Guide</a>
      <ul>
          
          
          
          <li><a href="monitoring-che.html">Monitoring Che</a></li>
          
          
          
          
          
          
          <li><a href="tracing-che.html">Tracing Che</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>

            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Tracing Che</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.
$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2' });
/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top
  $(window).scrollTop(scroll_target - 10);
  return false
})

});
</script>

<div id="toc"></div>

    


    <!-- 


     -->

  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Tracing helps gather timing data to troubleshoot latency problems in microservice architectures and helps to understand a complete transaction or workflow as it propagates through a distributed system.
Every transaction might reflect performance anomalies in an early phase when new services are being introduced by independent teams.</p>
</div>
<div class="paragraph">
<p>Tracers live in the applications. It records timing and metadata about operations that took place. They often instrument libraries, so that their use is transparent to users. For example, an instrumented web server records when it received a request and when it sent a response. The trace data collected is called a Span. Span has a context that contains information such as trace and span identifiers and other kinds of data that can be propagated down the line.</p>
</div>
<div class="paragraph">
<p>Che utilizes Opentracing API - a vendor-neutral framework for instrumentation. This means that if a developer wants to try out a different tracing backend, then instead of repeating the whole instrumentation process for the new distributed tracing system, the developer can simply change the configuration of the Tracer backend.</p>
</div>
<div class="paragraph">
<p>Currently, Jaeger was chosen as a tracing backend, Inspired by Dapper and OpenZipkin, is a distributed tracing system released as open source by Uber Technologies. Jaeger extends more complex architecture for a larger scale of requests and performance.</p>
</div>
<div class="paragraph">
<p>Tracing Che application may help analyse the execution of various operations, such as workspace creations, workspace startup, breaking down the duration of sub-operations executions, helping finding bottlenecks and improve the overall state of the platform.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="enabling-che-metrics-collections">Enabling Che metrics collections</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="prerequisites-tracing-che">Prerequisites</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Installed Jaeger v1.12.0 or above. See more <a href="https://www.jaegertracing.io/docs/1.12/getting-started/">https://www.jaegertracing.io/docs/1.12/getting-started/</a>.</p>
</li>
</ul>
</div>
<h2 id="procedure" class="discrete">Procedure</h2>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enable following environment variables for Che deployment</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre># Activating Che tracing modules
CHE_TRACING_ENABLED=true
# Following variables are the basic Jaeger client library configuration.
#
JAEGER_ENDPOINT="http://jaeger-collector:14268/api/traces"
# Service name
JAEGER_SERVICE_NAME="che-server"
# URL to remote sampler
JAEGER_SAMPLER_MANAGER_HOST_PORT="jaeger:5778"
# Type and param of sampler ( constant sampler for all traces )
JAEGER_SAMPLER_TYPE="const"
JAEGER_SAMPLER_PARAM="1"
#Maximum queue size of reporter
JAEGER_REPORTER_MAX_QUEUE_SIZE="10000"</pre>
</div>
</div>
<div class="paragraph">
<p>More about Jaeger client environment variables at <a href="https://github.com/jaegertracing/jaeger-client-go#environment-variables" class="bare">https://github.com/jaegertracing/jaeger-client-go#environment-variables</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="viewing-che-traces-on-jaeger-uitracing-che">Viewing Che traces on Jaeger UI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section demonstrates how to utilize Jaeger UI to overview traces of Che operations</p>
</div>
<h3 id="procedure-2" class="discrete">Procedure</h3>
<div class="paragraph">
<p>In this example, Che Instance has been running for some time and 1 workspace startup has occured. Now onto inspecting the certain trace of startup:</p>
</div>
<div class="paragraph">
<p>Search window on the left provides tools to filter out spans by the operation name (span name), tags, as well as limit spans by time and duration.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="../images/tracing/trace-search.png"><img src="../images/tracing/trace-search.png" alt="trace search"></a>
</div>
</div>
<div class="paragraph">
<p>Selecting the trace would expand it, showing the tree of nested spans, as well as additional info about highlighted span such as tags, durations</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="../images/tracing/trace-tree-expanded.png"><img src="../images/tracing/trace-tree-expanded.png" alt="trace tree expanded"></a>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="che-tracing-codebase-overview-and-extension-guidetracing-che">Che Tracing codebase overview and extension guide</h2>
<div class="sectionbody">
<h3 id="procedure-3" class="discrete">Procedure</h3>
<div class="paragraph">
<p>The core of tracing implementation for Che is placed at <code>che-core-tracing-core</code> and <code>che-core-tracing-web</code> modules.</p>
</div>
<div class="paragraph">
<p>The Che API has the following ways to provide tracing spans:
Currently, all HTTP requests to API will have its own trace. This is done by TracingFilter from <a href="https://github.com/opentracing-contrib/java-web-servlet-filter" class="bare">https://github.com/opentracing-contrib/java-web-servlet-filter</a>, bound for the whole server application.
Adding @Traced annotation to methods will cause the TracingInterceptor to add tracing spans for them.</p>
</div>
<div class="paragraph">
<p>Tags</p>
</div>
<div class="paragraph">
<p>Spans may contain some standard tags, such as operation name, span origin, error as well as there may be others, that may help users with querying and filtering them.
Like workspace related operations (like start or stop workspace) have additional tags such as userId, workspaceId, stackId.
Spans created by TracingFilter would also have an HTTP status code tag.</p>
</div>
<div class="paragraph">
<p>Declaring tags in a traced method is done statically, by setting fields from <code>TracingTags</code> class:</p>
</div>
<div class="paragraph">
<p><code>TracingTags.WORKSPACE_ID.set(workspace.getId());</code></p>
</div>
<div class="paragraph">
<p>TracingTags is a class where all commonly used tags are declared, as respective AnnotationAware Tag implementations.</p>
</div>
<h3 id="additional-resources" class="discrete">Additional resources</h3>
<div class="paragraph">
<p>For more information about how to use Jaeger UI, visit Jaeger documentation</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.jaegertracing.io/docs/1.12/getting-started/">Jaeger Getting Started Guide</a></p>
</li>
</ul>
</div>
</div>
</div>

    <div class="tags">
        
        <b>Tags: </b>
        
        
        
    </div>

<!-- 
 -->

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
                    Eclipse Che - Documentation <br/>
                    Site last generated: Jun 4, 2019 <br/>
                    <hr>
                    <a href="http://www.eclipse.org" target="_blank">Eclipse Foundation</a><br/>
                    <a href="http://www.eclipse.org/legal/privacy.php" target="_blank">Privacy Policy</a><br/>
                    <a href="http://www.eclipse.org/legal/termsofuse.php" target="_blank">Terms of Use</a><br/>
                    <a href="https://www.eclipse.org/legal/epl-2.0/" target="_blank">Eclipse Public License</a><br/>
                    <a href="http://www.eclipse.org/legal" target="_blank">Legal Resources</a><br/>
                </div>
            </div>
</footer>




    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>

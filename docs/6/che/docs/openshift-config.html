<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="installationopenshift,  openshift, configuration">
<title>Configuration: OpenShift | Eclipse Che Documentation</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="che" href="http://0.0.0.0:4000/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Eclipse Che Documentation</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="news">Release Notes</a></li>
                
                
                
                <li><a href="https://github.com/eclipse/che" target="_blank">Source Code</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Get Support<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/eclipse/che/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3Akind%2Fbug" target="_blank">Known Bugs</a></li>
                        
                        
                        
                        <li><a href="https://github.com/eclipse/che/issues/new" target="_blank">File an Issue</a></li>
                        
                        
                        
                        <li><a href="https://stackoverflow.com/questions/tagged/eclipse-che" target="_blank">Che on StackOverflow</a></li>
                        
                        
                    </ul>
                </li>
                
                
                <!-- 
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:?subject= feedback&body=I have some feedback about the Configuration: OpenShift page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>
 -->
		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Configuration: OpenShift">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle"> </li>
  
  
  
      
  
  <li>
      <a href="#">Overview</a>
      <ul>
          
          
          
          <li><a href="index.html">What Is Eclipse Che?</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Setup</a>
      <ul>
          
          
          
          <li><a href="single_multi_user.html">Single vs Multi-User</a></li>
          
          
          
          
          
          
          <li><a href="docker_openshift.html">Docker vs OpenShift</a></li>
          
          
          
          
          
          
          <li><a href="docker.html">Single-User on Docker</a></li>
          
          
          
          
          
          
          <li><a href="openshift.html">Single-User on OpenShift</a></li>
          
          
          
          
          
          
          <li><a href="multi-user-docker.html">Multi-User on Docker</a></li>
          
          
          
          
          
          
          <li><a href="multi-user-openshift.html">Multi-User on OpenShift</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Configuration</a>
      <ul>
          
          
          
          <li><a href="docker-config.html">Configuration on Docker</a></li>
          
          
          
          
          
          
          <li><a href="cli-reference.html">CLI Reference</a></li>
          
          
          
          
          
          
          <li class="active"><a href="openshift-config.html">Configuration on OpenShift</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Framework</a>
      <ul>
          
          
          
          <li><a href="framework_overview.html">Overview</a></li>
          
          
          
          
          
          
          <li><a href="che_master.html">Master</a></li>
          
          
          
          
          
          
          <li><a href="rest_api.html">REST API</a></li>
          
          
          
          
          
          
          <li><a href="dao.html">Persistence, DAO</a></li>
          
          
          
          
          
          
          <li><a href="registry.html">Registry</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Workspaces</a>
      <ul>
          
          
          
          <li><a href="what_are_workspaces.html">Model</a></li>
          
          
          
          
          
          
          <li><a href="workspaces_rest_api.html">REST API</a></li>
          
          
          
          
          
          
          <li><a href="environments.html">Environments</a></li>
          
          
          
          
          
          
          <li><a href="servers.html">Servers</a></li>
          
          
          
          
          
          
          <li><a href="recipes.html">Recipes</a></li>
          
          
          
          
          
          
          <li><a href="installers.html">Installers</a></li>
          
          
          
          
          
          
          <li><a href="volumes.html">Volumes</a></li>
          
          
          
          
          
          
          <li><a href="env_variables.html">Env Variables</a></li>
          
          
          
          
          
          
          <li><a href="projects.html">Projects</a></li>
          
          
          
          
          
          
          <li><a href="workspaces_troubleshooting.html">Troubleshooting</a></li>
          
          
          
          
          
          
          <li><a href="workspace_data_model.html">Workspace Data Model</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Workspace Delivery</a>
      <ul>
          
          
          
          <li><a href="creating_starting_workspaces.html">Creating and starting Workspaces</a></li>
          
          
          
          
          
          
          <li><a href="factories_getting_started.html">Factories Getting Started</a></li>
          
          
          
          
          
          
          <li><a href="creating_factories.html">Creating Factories</a></li>
          
          
          
          
          
          
          <li><a href="factories_json_reference.html">Factories JSON Reference</a></li>
          
          
          
          
          
          
          <li><a href="stacks.html">Stacks</a></li>
          
          
          
          
          
          
          <li><a href="chedir_getting_started.html">Chedir Getting Started</a></li>
          
          
          
          
          
          
          <li><a href="why_chedir.html">Why Chedir?</a></li>
          
          
          
          
          
          
          <li><a href="chedir_installation.html">Installation</a></li>
          
          
          
          
          
          
          <li><a href="chedir_project_setup.html">Project Setup</a></li>
          
          
          
          
          
          
          <li><a href="chedir_up_and_down.html">Up and Down</a></li>
          
          
          
          
          
          
          <li><a href="chefile.html">Chefile</a></li>
          
          
          
          
          
          
          <li><a href="chedir_ssh.html">SSH</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">IDE and Editor</a>
      <ul>
          
          
          
          <li><a href="ide_projects.html">Projects</a></li>
          
          
          
          
          
          
          <li><a href="editor_code_assistance.html">Editor and Code-Assistance</a></li>
          
          
          
          
          
          
          <li><a href="dependency_management.html">Dependency Management</a></li>
          
          
          
          
          
          
          <li><a href="commands_ide_macro.html">Commands and IDE Macros</a></li>
          
          
          
          
          
          
          <li><a href="version_control.html">Version Control</a></li>
          
          
          
          
          
          
          <li><a href="debug.html">Debug</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Multi-User</a>
      <ul>
          
          
          
          <li><a href="user-management.html">Authentication and Authorization</a></li>
          
          
          
          
          
          
          <li><a href="authentication.html">Security Model</a></li>
          
          
          
          
          
          
          <li><a href="permissions.html">Permissions</a></li>
          
          
          
          
          
          
          <li><a href="organizations.html">Organizations in UD</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Infrastructure and SPI</a>
      <ul>
          
          
          
          <li><a href="spi_overview.html">Overview</a></li>
          
          
          
          
          
          
          <li><a href="spi_implementation.html">Implementation Notes</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Extensibility</a>
      <ul>
          
          
          
          <li><a href="che_in_che_quickstart.html">Quick-Start&#58 Your First Plugin</a></li>
          
          
          
          
          
          
          <li><a href="assemblies.html">Assemblies</a></li>
          
          
          
          
          
          
          <li><a href="ide-extensions-gwt.html">GWT IDE Extensions</a></li>
          
          
          
          
          
          
          <li><a href="ide-extensions-js.html">JavaScript IDE Extensions</a></li>
          
          
          
          
          
          
          <li><a href="server-side-extensions.html">Server Side Agents</a></li>
          
          
          
          
          
          
          <li><a href="project_types.html">Project Types</a></li>
          
          
          
          
          
          
          <li><a href="language_servers.html">Language Servers</a></li>
          
          
          
          
          
          
          <li><a href="parts.html">IDE UI&#58 Parts</a></li>
          
          
          
          
          
          
          <li><a href="actions.html">IDE UI&#58 Actions</a></li>
          
          
          
          
          
          
          <li><a href="editor.html">IDE UI&#58 Editor</a></li>
          
          
          
          
          
          
          <li><a href="themes.html">IDE UI&#58 Themes</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Dev Essentials</a>
      <ul>
          
          
          
          <li><a href="guice.html">Dependency Injection</a></li>
          
          
          
          
          
          
          <li><a href="dto.html">Transport&#58 DTO</a></li>
          
          
          
          
          
          
          <li><a href="json-rpc.html">Communication&#58 JSON-RPC</a></li>
          
          
          
          
          
          
          <li><a href="handling-projects-in-plugins.html">Handling Projects in Plugins</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>

            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Configuration: OpenShift</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.
$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2' });
/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top
  $(window).scrollTop(scroll_target - 10);
  return false
})

});
</script>

<div id="toc"></div>

    


    <!-- 


     -->

  <h2 id="how-it-works">How It Works</h2>

<p>You can configure deployment of Che on OpenShift with env variables that are defined in <code class="highlighter-rouge">che-config</code> file. Either export env in your terminal, or edit this file directly. Once done, run the deployment script with <code class="highlighter-rouge">-c rollupdate</code> flag. Che deployment will be updated which automatically triggers a new deployment. You can also export envs in your environment, and the script will pick them up. It will only update Che server pod. This page focuses on some of the envs. You can either look at <a href="docker-config.html">Docker configuration page</a> or <a href="https://github.com/eclipse/che/blob/master/dockerfiles/init/manifests/che.env">che.env</a> file.</p>

<p>We use recreate strategy. When the initial Che pod is shut down, server forcefully stops all workspace pods. Users working in those workspace will see a notification that the workspace is not running anymore. It does not impact data persistence - all workspace project files mounted through PVCs.</p>

<h2 id="update">Update</h2>

<p>Export <code class="highlighter-rouge">CHE_IMAGE_TAG=${VERSION}</code> before executing <code class="highlighter-rouge">che_deploy.sh -c rollupdate</code>, where <code class="highlighter-rouge">${VERSION}</code> is a tag you want to update to. If you have your custom Che server image, you may export <code class="highlighter-rouge">CHE_IMAGE_REPO</code> too. You can get available tags on <a href="https://github.com/eclipse/che/tags">Github</a> or <a href="https://hub.docker.com/r/eclipse/che/tags/">DockerHub</a>.</p>

<p>If you want to always use the latest nightly builds, run <code class="highlighter-rouge">export IMAGE_PULL_POLICY=Always</code> and then re-run the deployment script. This way, OpenShift will always pull the image referenced in the deployment.</p>

<p>Downgrades are possible, however, if database migrations have been previously performed, Che pod will fail to start.</p>

<h2 id="openshift-flavor">OpenShift Flavor</h2>

<p><code class="highlighter-rouge">OPENSHIFT_FLAVOR</code> defaults to <code class="highlighter-rouge">minishift</code>. Allowed values: <code class="highlighter-rouge">ocp</code>, <code class="highlighter-rouge">osio</code></p>

<h2 id="username-password-token">Username, Password, Token</h2>

<p>Deployment script needs access to a running OpenShift instance either via username/password or a token:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CHE_INFRA_OPENSHIFT_USERNAME
CHE_INFRA_OPENSHIFT_PASSWORD
CHE_INFRA_OPENSHIFT_TOKEN
</code></pre></div></div>
<p>If token is set, it is used by <code class="highlighter-rouge">oc</code> client to log in and Che server to create namespaces and objects, else default credentials are used (<code class="highlighter-rouge">developer/developer</code>) for MiniShift and OCP.</p>

<p>All objects that Che server creates such as workspace pods, services, routes and PVCs are created on behalf of this user. As a result, other OpenShift users who create workspaces in a multi-user Che, have no access to these objects.</p>

<p>This is going to be changed once <a href="https://github.com/eclipse/che/issues/8178">this issue</a> is completed.</p>

<h2 id="namespace-for-workspaces">Namespace for Workspaces</h2>

<p>You can instruct Che server in what namespace(s) to create workspace pods. There are two scenarios. By default, every new workspace pod is created in a new namespace which is dictated by the following env:</p>

<p><code class="highlighter-rouge">CHE_INFRA_OPENSHIFT_PROJECT=""</code></p>

<p>You may have one common namespace for all workspace pods:</p>

<p><code class="highlighter-rouge">CHE_INFRA_OPENSHIFT_PROJECT="che-workspaces"</code></p>

<p>If workspaces are created in the same namespace with Che server, a service account may be used instead of a token or credentials.</p>

<h2 id="volumes">Volumes</h2>

<p><code class="highlighter-rouge">CHE_INFRA_OPENSHIFT_PVC_STRATEGY="unique"</code></p>

<p>There are two <a href="https://docs.openshift.com/container-platform/3.7/dev_guide/persistent_volumes.html">Persistent Volume Claim</a> strategies:</p>

<ul>
  <li><strong>unique</strong> - each workspace gets own PVC.  This is the default strategy. When a workspace is deleted, associated PVC is deleted as well. However, an associated PV may not be recycled and tghus cannot be re-used for a new claim. See <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#recycling">k8s docs</a>. If you have started your cluster with <code class="highlighter-rouge">oc cluster up</code>, you need to create a service account for a special recycler pod: <code class="highlighter-rouge">oc create serviceaccount pv-recycler-controller -n openshift-infra</code> (requires admin login)</li>
  <li><strong>common</strong> - there is one PVC for all workaspaces. When a PVC is shared with all workspaces, there’s a special service pod that starts before workspace is created to create a subpath in the PV for this particular ws. When a workspace is deleted an associated subpath is deleted as well.</li>
</ul>

<p>If a common strategy is set, it is impossible to run multiple workspaces simultaneously because of a default <code class="highlighter-rouge">ReadWriteOnce</code> <a href="https://docs.openshift.com/container-platform/3.7/architecture/additional_concepts/storage.html#pv-access-modes">access mode</a> for workspace PVCs.</p>

<p>OpenShift cluster admins may want to study docs on <a href="https://docs.openshift.com/container-platform/3.7/install_config/persistent_storage/index.html">distributed volumes</a> and <a href="https://docs.openshift.com/container-platform/3.7/admin_guide/quota.html">applying resource limits</a>.</p>

<h2 id="https-mode">HTTPS Mode</h2>

<p>To enable https for server and workspace routes, export the following environment variable:</p>

<p><code class="highlighter-rouge">ENABLE_SSL=true</code></p>

<p>When deploying to OSIO, HTTPS is enabled by default.</p>

<h2 id="scalability">Scalability</h2>

<p>To be able to run more workspaces, <a href="https://docs.openshift.com/container-platform/3.7/admin_guide/manage_nodes.html">add more nodes to your OpenShift cluster</a>. If the system is out of resources, workspace start will fail with an error message returned from OpenShift (usually it’s <code class="highlighter-rouge">no available nodes</code> kind of error).</p>

<h2 id="debug-mode">Debug Mode</h2>

<p>If you want Che server to run in a debug mode export the following env before running the script (false by default):</p>

<p><code class="highlighter-rouge">CHE_DEBUG_SERVER=true</code></p>

<h2 id="image-pull-policy">Image Pull Policy</h2>

<p>If you want to always have the latest nightly image or use own latest tags when developing and testing Che</p>

<p><code class="highlighter-rouge">IMAGE_PULL_POLICY</code></p>

<h2 id="private-docker-registries">Private Docker Registries</h2>

<p>Refer to <a href="https://docs.openshift.com/container-platform/3.7/security/registries.html">OpenShift documentation</a></p>

<h2 id="enable-ssh-and-sudo">Enable ssh and sudo</h2>

<p>By default, pods are run with an arbitrary user that has a randomly generated UID (the range is defined in OpenShift config file). This security constrain has several consequences for Eclipse Che users:</p>

<ul>
  <li>installers for language servers will fail since most of them require <code class="highlighter-rouge">sudo</code></li>
  <li>no way to run any sudo commands in a running workspace</li>
</ul>

<p>It is possible to allow root access which in its turn allows running system services and change file/directory <a href="#filesystem-permissions">permissions</a>. You can change this behavior. See <a href="https://docs.openshift.com/container-platform/3.6/admin_guide/manage_scc.html#enable-images-to-run-with-user-in-the-dockerfile">OpenShift Documentation for details</a>.</p>

<p>You may also configure some services to bind to ports below <code class="highlighter-rouge">1024</code>, say, apache2. Here’s an example of enabling it for <a href="https://github.com/eclipse/che-dockerfiles/blob/master/recipes/php/Dockerfile#L49">Apache2</a> in a PHP image.</p>

<p><strong>How to Get a Shell in a Pod?</strong></p>

<p>Since OpenShift routes do not support ssh protocol, once cannot run sshd (or equivalent) in a pod and ssh into it. However, OpenShift itself provides a few alternatives (only for users who can authenticate as a user that has deployed Che):</p>

<ul>
  <li><code class="highlighter-rouge">oc rsh ${POD_NAME}</code> (you can get running pods with <code class="highlighter-rouge">oc</code>). Note that this is a remote shell, not an ssh connection</li>
  <li>in an OpenShift <strong>web console, projects &gt; ws-namespace &gt; pods &gt; pod details &gt; Terminal</strong>.</li>
</ul>

<p>Once Che server is able to create OpenShift objects on behalf of a current user, rsh will be available for all users. You may follow GitHub <a href="https://github.com/eclipse/che/issues/8178">issue</a> to get updates.</p>

<h2 id="filesystem-permissions">Filesystem Permissions</h2>

<p>As said above, pods in OpenShift are started with an arbitrary user with a dynamic UID that is generated for each namespace individually. As a result, a user in an OpenShift pod does not have write permissions for files and directories unless root group (UID - <code class="highlighter-rouge">0</code>) has write permissions for those (an arbitrary user in OpenShift belongs to root group). All Che ready to go stacks are optimized to run well on OpenShift. See an example from a <a href="https://github.com/eclipse/che-dockerfiles/blob/master/recipes/stack-base/centos/Dockerfile#L45-L48">base image</a>. What happens there is that a root group has write permissions for <code class="highlighter-rouge">/projects</code> (where workspace projects are located), a user home directory and some other dirs.</p>

<h2 id="che-server-logs">Che Server Logs</h2>

<p>When Eclipse Che gets deployed to OpenShift, a PVC <code class="highlighter-rouge">che-data-volume</code> is <a href="https://github.com/eclipse/che/blob/master/dockerfiles/init/modules/openshift/files/scripts/che-openshift.yml#L30">created</a> and bound to a PV. Logs are persisted in a PV and can be retrieved in the following ways:</p>

<ul>
  <li><code class="highlighter-rouge">oc get log dc/che</code></li>
  <li><code class="highlighter-rouge">oc describe pvc che-data-claim</code>, find PV it is bound to, then <code class="highlighter-rouge">oc describe pv $pvName</code>, you will get a local path with logs directory. Be careful with permissions for that directory, since once changed, Che server wont be able to write to a file</li>
  <li>in OpenShift web console, eclipse-che project, <strong>pods &gt; che-pod &gt; logs</strong>.</li>
</ul>

<h2 id="multi-user-using-own-keycloak-and-psql">Multi-User: Using Own Keycloak and PSQL</h2>

<p>Out of the box Che is deployed together with Keycloak and Postgres pods, and all three services are properly configured to be able to communicate. However, it does not matter for Che what Keycloak server and Postgres DB to use, as long as those have compatible versions and meet certain requirements.</p>

<p><strong><em>Che Server and Keycloak</em></strong></p>

<p>KeyCloak server URL is retrieved from the <code class="highlighter-rouge">CHE_KEYCLOAK_AUTH__SERVER__URL</code> environment variable. A new installation of Che will use its own Keycloak server running in a Docker container pre-configured to communicate with Che server. Realm and client are mandatory environment variables. By default Keycloak environment variables are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CHE_KEYCLOAK_AUTH__SERVER__URL=http://${KC_ROUTE}:5050/auth
CHE_KEYCLOAK_REALM=che
CHE_KEYCLOAK_CLIENT__ID=che-public
</code></pre></div></div>

<p>You can use your own Keycloak server. Create a new realm and a public client. A few things to keep in mind:</p>

<ul>
  <li>It must be a public client</li>
  <li><code class="highlighter-rouge">redirectUris</code> should be <code class="highlighter-rouge">${CHE_SERVER_ROUTE}/*</code>. If no or incorrect <code class="highlighter-rouge">redirectUris</code> are provided or the one used is not in the list of <code class="highlighter-rouge">redirectUris</code>, Keycloak will display an error saying that redirect_uri param is invalid.</li>
  <li><code class="highlighter-rouge">webOrigins</code> should be  either<code class="highlighter-rouge">${CHE_SERVER_ROUTE}</code> or <code class="highlighter-rouge">*</code>. If no or incorrect <code class="highlighter-rouge">webOrigins</code> are provided, Keycloak script won’t be injected into a page because of CORS error.</li>
</ul>

<p><strong><em>Che Server and PostgreSQL</em></strong></p>

<p>Che server uses the below defaults to connect to PostgreSQL to store info related to users, user preferences and workspaces:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CHE_JDBC_USERNAME=pgche
CHE_JDBC_PASSWORD=pgchepassword
CHE_JDBC_DATABASE=dbche
CHE_JDBC_URL=jdbc:postgresql://postgres:5432/dbche
CHE_JDBC_DRIVER__CLASS__NAME=org.postgresql.Driver
CHE_JDBC_MAX__TOTAL=20
CHE_JDBC_MAX__IDLE=10
CHE_JDBC_MAX__WAIT__MILLIS=-1
</code></pre></div></div>

<p>Che currently uses version 9.6.</p>

<p><strong><em>Keycloak and PostgreSQL</em></strong></p>

<p>Database URL, port, database name, user and password are defined as environment variables in Keycloak pod. Defaults are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POSTGRES_PORT_5432_TCP_ADDR=postgres
POSTGRES_PORT_5432_TCP_PORT=5432
POSTGRES_DATABASE=keycloak
POSTGRES_USER=keycloak
POSTGRES_PASSWORD=keycloak
</code></pre></div></div>

<h2 id="development-mode">Development Mode</h2>

<p>After you have built your <a href="assemblies.html">custom assembly</a>, execute <code class="highlighter-rouge">build.sh</code> <a href="https://github.com/eclipse/che/tree/master/dockerfiles/che">script</a>. You can then tag it, either push to MiniShift or a public Docker registry, and reference in your Che deployment as <code class="highlighter-rouge">CHE_IMAGE_REPO</code> and <code class="highlighter-rouge">CHE_IMAGE_TAG</code>.</p>



    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        <a href="tag_installation.html" class="btn btn-default navbar-btn cursorNorm" role="button">installation</a>
        
        
        
        <a href="tag_openshift.html" class="btn btn-default navbar-btn cursorNorm" role="button">openshift</a>
        
        
        
    </div>

<!-- 
 -->

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               01/22/18 <br /> Eclipse Che: Eclipse Public License - v 1.0. <br />
 Site last generated: Jan 22, 2018 <br />
<p><img src="images/che_logo.png" alt="Eclise Che"/></p>
                </div>
            </div>
</footer>




    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
